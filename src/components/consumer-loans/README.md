# מודול הלוואות צרכניות

מערכת מתקדמת לתכנון, השוואה ואופטימיזציה של הלוואות צרכניות.

## תכונות עיקריות

### 1. ניהול הלוואות
- הוספה, עריכה ומחיקה של הלוואות צרכניות
- חישוב אוטומטי של החזר חודשי לפי נוסחת האנונה
- הצגת סך ריבית וסך תשלומים

### 2. טבלת סילוקין
- טבלה מפורטת לכל חודש: ריבית, קרן, יתרה
- תמיכה בפרעון מוקדם במצב "reduce" (תשלום קטן יותר, תקופה זהה)
- ייצוא לקובץ CSV

### 3. השוואת הלוואות
- השוואה בין 2-4 הלוואות בו-זמנית
- גרף עמודות אינטראקטיבי
- סיכום מהיר של התרחיש הטוב ביותר

### 4. מודול שילובים ואופטימיזציה
- **תרחיש A (ללא איחוד)**: הקצאת מזומן בשיטת Avalanche + הלוואה חדשה בצורך
- **תרחיש B (איחוד מלא)**: הלוואת איחוד אחת לכל הצרכים
- בחירת מטרה: מינימום ריבית או מינימום החזר חודשי
- תמיכה בתקציב חודשי מקסימלי

## נוסחאות מתמטיות

### תשלום חודשי (אנונה)
```
r = annualRatePct / 100 / 12
אם |r| < 1e-12: payment = P / n
אחרת: payment = P * r * (1+r)^n / ((1+r)^n - 1)
```

### פרעון מוקדם (מצב reduce)
לאחר הפחתת הקרן, מחושב תשלום חדש:
```
paymentNew = annuityPayment(balanceNew, apr, remainingMonths)
```

## קבצי המודול

- `types.ts` - הגדרות טיפוסים
- `loanMath.ts` - פונקציות מתמטיות לחישוב הלוואות
- `optimizer.ts` - אלגוריתמי אופטימיזציה
- `LoanCard.tsx` - כרטיס הלוואה עם עריכה
- `AmortTable.tsx` - טבלת סילוקין עם פרעון מוקדם
- `ComparePanel.tsx` - השוואת הלוואות
- `OptimizePanel.tsx` - מודול האופטימיזציה
- `LoanPlanner.tsx` - קומפוננטה ראשית

## בדיקות

הרץ בדיקות:
```bash
npm test
```

כל הבדיקות כוללות:
- חישובי אנונה מדויקים
- אלגוריתם Avalanche
- תרחישי אופטימיזציה
- פרעון מוקדם

## שימוש

הדף זמין בכתובת: `/consumer-loans`

המערכת שומרת את כל הנתונים ב-localStorage ותומכת מלא ב-RTL ועברית.